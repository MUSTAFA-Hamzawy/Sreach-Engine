[2013-08-07 -- add this changelist! page size is now adjustable pagination api.&& 2013-08-07 -- added support for counters and field order..&& 2013-08-03 -- added support for collapsing.&& changelist.&& basic usage.&& url match scope.&& output format (json).&& field order.&& filtering.&& collapsing.&& query result limits.&& closest timestamp match.&& resumption key.&& resolve revisits.&& counters.&& duplicate counter.&& skip counter.&& pagination api.&& access control.&& the wayback-cdx-server is a standalone http servlet that serves the index that the wayback machine uses to lookup captures..&& the index format is known as cdx and contains various fields representing the capture.&& usually sorted by url and date. http://archive.org/web/researcher/cdx_file_format.php.&& the server responds to get queries and returns either the plain text cdx data.&& or optionally a json array of the cdx..&& the cdx server is deployed as part of web.archive.org wayback machine and the usage below reference this deployment..&& however.&& the cdx server is freely available with the rest of the open-source wayback machine software in this repository..&& further documentation will focus on configuration and deployment in other environments..&& please contant us at wwm@archive.org for additional questions..&& the most simple query and the only required param for the cdx server is the url param.&& the above query will return a portion of the index.&& one per row.&& for each capture of the url archive.org that is available in the archive..&& the columns of each line are the fields of the cdx. at this time.&& the following cdx fields are publicly available:.&& [urlkey.&&timestamp.&&original.&&mimetype.&&statuscode.&&digest.&&length].&& it is possible to customize the field order as well..&& the the url= value should be url encoded if the url itself contains a query..&& all other params are optional and are explained below..&& for doing large/bulk queries.&& the use of the pagination api is recommended..&& the default behavior is to return matches for an exact url. however.&& the cdx server can also return results matching a certain prefix.&& a certain host or all subdomains by using the matchtype= param..&& for example.&& if given the url: archive.org/about/ and:.&& matchtype=exact (default if omitted) will return results matching exactly archive.org/about/.&& matchtype=prefix will return results for all results under the path archive.org/about/.&& http://web.archive.org/cdx/search/cdx?url=archive.org/about/&matchtype=prefix&limit=1000.&& matchtype=host will return results from host archive.org.&& http://web.archive.org/cdx/search/cdx?url=archive.org/about/&matchtype=host&limit=1000.&& matchtype=domain will return results from host archive.org and all subhosts *.archive.org.&& http://web.archive.org/cdx/search/cdx?url=archive.org/about/&matchtype=domain&limit=1000.&& the matchtype may also be set implicitly by using wildcard * at end or beginning of the url:.&& (note: the domain mode is only available if the cdx is in surt-order format.).&& output: output=json can be added to return results as json array. the json output currently also includes a first line which indicates the cdx format..&& ex: http://web.archive.org/cdx/search/cdx?url=archive.org&output=json&limit=3.&& it is possible to customize the fields returned from the cdx server using the fl= param. simply pass in a comma separated list of fields and only those fields will be returned:.&& the following returns only the timestamp and mimetype fields with the header [timestamp.&&mimetype] http://web.archive.org/cdx/search/cdx?url=archive.org&fl=timestamp.&&mimetype&output=json.&& if omitted.&& all the available fields are returned by default..&& date range: results may be filtered by timestamp using from= and to= params. the ranges are inclusive and are specified in the same 1 to 14 digit format used for wayback captures: yyyymmddhhmmss.&& ex: http://web.archive.org/cdx/search/cdx?url=archive.org&from=2010&to=2011.&& regex filtering: it is possible to filter on a specific field or the entire cdx line (which is space delimited). filtering by specific field is often simpler. any number of filter params of the following form may be specified: filter=[!]field:regex may be specified..&& field is one of the named cdx fields (listed in the json query) or an index of the field. it is often useful to filter by mimetype or statuscode.&& optional: ! before the query inverts the match.&& that is.&& will return results that do not match the regex..&& regex is any standard java regex pattern (http://docs.oracle.com/javase/6/docs/api/java/util/regex/pattern.html).&& ex: query for 2 capture results with a non-200 status code:.&& http://web.archive.org/cdx/search/cdx?url=archive.org&output=json&limit=2&filter=!statuscode:200.&& ex: query for 10 capture results with a non-200 status code and non text/html mime type matching a specific digest:.&& http://web.archive.org/cdx/search/cdx?url=archive.org&output=json&limit=10&filter=!statuscode:200&filter=!mimetype:text/html&filter=digest:2waxx5nuwnncs2bdkco5ovdqbjvnkivv.&& a new form of filtering is the option to collapse results based on a field.&& or a substring of a field. collapsing is done on adjacent cdx lines where all captures after the first one that are duplicate are filtered out. this is useful for filtering out captures that are too dense or when looking for unique captures..&& to use collapsing.&& add one or more collapse=field or collapse=field:n where n is the first n characters of field to test..&& ex: only show at most 1 capture per hour (compare the first 10 digits of the timestamp field). given 2 captures 20130226010000 and 20130226010800.&& since first 10 digits 2013022601 match.&& the 2nd capture will be filtered out..&& http://web.archive.org/cdx/search/cdx?url=google.com&collapse=timestamp:10.&& the calendar page at web.archive.org uses this filter by default: http://web.archive.org/web/*/archive.org.&& ex: only show unique captures by digest (note that only adjacent digest are collapsed.&& duplicates elsewhere in the cdx are not affected).&& http://web.archive.org/cdx/search/cdx?url=archive.org&collapse=digest.&& ex: only show unique urls in a prefix query (filtering out captures except first capture of a given url). this is similar to the old prefix query in wayback (note: this query may be slow at the moment):.&& http://web.archive.org/cdx/search/cdx?url=archive.org&collapse=urlkey&matchtype=prefix.&& as the cdx server may return millions or billions of record.&& it is often necessary to set limits on a single query for practical reasons. the cdx server provides several mechanisms.&& including ability to return the last n as well as first n results..&& the cdx server config provides a setting for absolute maximum length returned from a single query (currently set to 150000 by default)..&& set limit= n to return the first n results..&& set limit= -n to return the last n results. the query may be slow as it begins reading from the beginning of the search space and skips all but last n results..&& ex: http://web.archive.org/cdx/search/cdx?url=archive.org&limit=-1.&& advanced option: fastlatest=true may be set to return some number of latest results for an exact match and is faster than the standard last results search. the number of results is at least 1 so limit=-1 implies this setting. the number of results may be greater >1 when a secondary index format (such as zipnum) is used.&& but is not guaranteed to return any more than 1 result. combining this setting with limit= will ensure that no more than n last results..&& ex: this query will result in upto 5 of the latest (by date) query results:.&& http://web.archive.org/cdx/search/cdx?url=archive.org&fastlatest=true&limit=-5.&& the offset= m param can be used in conjunction with limit to skip the first m records. this allows for a simple way to scroll through the results..&& however.&& the offset/limit model does not scale well to large querties since the cdx server must read and skip through the number of results specified by offset.&& so the cdx server begins reading at the beginning every time..&& the following features are for more specific/advanced usage of the cdx server..&& there is also a new method that allows for the cdx server to specify resumption key that can be used to continue the query from the previous end. this allows breaking up a large query into smaller queries more efficiently. this can be achieved by using showresumekey= and resumekey= params.&& to show the resumption key add showresumekey=true param. when set.&& the resume key will be printed only if the query has more results that have not be printed due to limit= (or max query limit) number of results reached..&& after the end of the query.&& the will be printed on a seperate line or seperate json query..&& plain text example: http://web.archive.org/cdx/search/cdx?url=archive.org&limit=5&showresumekey=true.&& in a subsequent query.&& adding resumekey= will resume the search from the next result: no other params from the original query (such as from= or url=) need to be altered to continue from the previous example.&& the subsequent query would be:.&& ex: http://web.archive.org/cdx/search/cdx?url=archive.org&limit=5&showresumekey=true&resumekey=org%2carchive%29%2f+19980109140106%21.&& there is some work on custom counters to enchance the aggregation capabilities of cdx server. these features are brand new and should be considered experimental..&& while collapsing allows for filtering out adjacent results that are duplicates.&& it is also possible to track duplicates throughout the cdx using a special new extension. by adding the showdupecount=true a new dupecount column will be added to the results..&& the duplicates are determined by tracking rows with the same digest field..&& the warc/revisit mimetype in duplicates > 0 will automatically be resolved to the mimetype of the original.&& if found..&& using showdupecount=true will only show unique captures: http://web.archive.org/cdx/search/cdx?url=archive.org&showdupecount=true&output=json&limit=50.&& it is possible to track how many cdx lines were skipped due to filtering and collapsing by adding the special skipcount counter with showskipcount=true. an optional endtimestamp count can also be used to print the timestamp of the last capture by adding lastskiptimestamp=true.&& ex: collapse results by year and print number of additional captures skipped and timestamp of last capture:.&& http://web.archive.org/cdx/search/cdx?url=archive.org&collapse=timestamp:4&output=json&showskipcount=true&lastskiptimestamp=true.&& the above resume key allows for sequential querying of cdx data. however.&& in some cases where very large querying is needed (for example domain query).&& it may be useful to perform queries in parallel and also estimate the total size of the query..&& wayback and cdx-server support a secondary loading from a zipnum cdx index. this index contains cdx lines stored in concatenated gzip blocks (usually 3.&&000 lines each) and a secondary index which provides binary search to the zipnum blocks. by using the secondary index.&& it is possible to estimate the total size of a query and also break up the query in size. using the zipnum format or other secondary index is needed to support pagination..&& however.&& pagination can only work on a single index at a time; merging input from multiple sources (plain cdx or zipnum) is not possible. as such.&& the results from a paginated query may be slightly less up-to-date than a default non-paginated query..&& to use pagination.&& simply add the page=i param to the query to return the i-th page. if pagination is not supported.&& the cdx server will return a 400..&& pages are numbered from 0 to num pages - 1. if i<0.&& pages are not used. if i>=num pages.&& no results are returned..&& ex: first page: http://web.archive.org/cdx/search/cdx?url=archive.org&page=0.&& ex: next page: http://web.archive.org/cdx/search/cdx?url=archive.org&page=1.&& to determine the number of pages.&& add the shownumpages=true param. this is a special query that will return a single number indicating the number of pages.&& ex: http://web.archive.org/cdx/search/cdx?url=archive.org&shownumpages=true.&& page size is the number of zipnum blocks scanned per page (so a page size of 1 will contain up to 3.&&000 results per page). this means the number of results on each page will vary.&& because each block may have a different number of cdx lines matching your query. page size is configured to an optimal value on the cdx server.&& and may be similar to max query limit in non-paged mode. the cdx server on archive.org currently has a page size of 50..&& it is possible to adjust the page size to a smaller value than the default by setting the pagesize=p where 1 <= p <= default page size..&& ex: get # of pages with smallest page size: http://web.archive.org/cdx/search/cdx?url=archive.org&shownumpages=true&pagesize=1.&& ex: get first page with smallest page size: http://web.archive.org/cdx/search/cdx?url=archive.org&page=0&pagesize=1.&& if there is only one page.&& adding the page=0 param will return the same results as without setting a page..&& it is also possible to have the cdx server return the raw secondary index.&& by specifying showpagedindex=true. this query returns the secondary index instead of the cdx results and may be subject to access restrictions..&& all other params.&& including the resumekey= should work in conjunction with pagination..&& the cdx server is designed to improve access to archived data to a broad audience.&& but it may be necessary to restrict certain parts of the cdx..&& the cdx server provides greanting permissions to restricted data via an api key that is passed in as a cookie..&& currently two restrictions/permission types are supported:.&& access to certain urls which are considered private. when restricted.&& only public urls are included in query results and access to secondary index is restricted..&& access to certain fields.&& such as filename in the cdx. when restricted.&& the cdx results contain only public fields..&& to allow access.&& the api key cookie must be explicitly set on the client.&& eg:.&& the api-key-secret can be set in the cdx server configuration..&& todo.&& start by editing the wayback-cdx-server-servlet.xml file in the web-inf directory. just put some valid cdx-files in the cdxuris-list (files must end with cdx or cdx.gz!)][internetarchive / wayback public, latest commit, git stats, files, readme.md, wayback cdx server api - beta, intro and usage, basic usage, url match scope, output format (json), field order, filtering, collapsing, query result limits, advanced usage, resumption key, counters, pagination api, access control, cdx server configuration]wayback/wayback-cdx-server at master · internetarchive/wayback · github[wayback, wayback-cdx-server, wayback-cdx-server, history, url, url=, matchtype=, matchtype=exact, matchtype=prefix, matchtype=host, matchtype=domain, url=archive.org/*, url=archive.org/&matchtype=prefix, url=*.archive.org/, url=archive.org/&matchtype=domain, output=json, gzip=false, fl=, from=, to=, filter=, collapse=field, collapse=field:n, limit=, limit=, fastlatest=true, limit=-1, limit=, offset=, offset, showresumekey=, resumekey=, showresumekey=true, limit=, resumekey=, showdupecount=true, showdupecount=true, showskipcount=true, lastskiptimestamp=true, page=i, shownumpages=true, pagesize=p, page=0, showpagedindex=true][product features mobile actions codespaces packages security code review issues integrations github sponsors customer stories, features, mobile, actions, codespaces, packages, security, code review, issues, integrations, github sponsors, customer stories, team, enterprise, explore explore github learn and contribute topics collections trending learning lab open source guides connect with others the readme project events community forum github education github stars program, explore github, learn and contribute, topics, collections, trending, learning lab, open source guides, connect with others, the readme project, events, community forum, github education, github stars program, marketplace, pricing plans compare plans contact sales education, plans, compare plans, contact sales, education, in this repository all github ↵ jump to ↵, no suggested jump to results, in this repository all github ↵ jump to ↵, in this organization all github ↵ jump to ↵, in this repository all github ↵ jump to ↵, notifications, fork 259, star 533, code, issues 75, pull requests 11, actions, projects 0, wiki, security, insights, code, issues, pull requests, actions, projects, wiki, security, insights, history, 2013-08-07 -- add this changelist! page size is now adjustable pagination api, 2013-08-07 -- added support for counters and field order., 2013-08-03 -- added support for collapsing, changelist, basic usage, url match scope, output format (json), field order, filtering, collapsing, query result limits, closest timestamp match, resumption key, resolve revisits, counters duplicate counter skip counter, duplicate counter, skip counter, pagination api, access control, http://web.archive.org/cdx/search/cdx?url=archive.org, matchtype=exact (default if omitted) will return results matching exactly archive.org/about/, matchtype=prefix will return results for all results under the path archive.org/about/ http://web.archive.org/cdx/search/cdx?url=archive.org/about/&matchtype=prefix&limit=1000, matchtype=host will return results from host archive.org http://web.archive.org/cdx/search/cdx?url=archive.org/about/&matchtype=host&limit=1000, matchtype=domain will return results from host archive.org and all subhosts *.archive.org http://web.archive.org/cdx/search/cdx?url=archive.org/about/&matchtype=domain&limit=1000, if url is ends in /*, eg url=archive.org/* the query is equivalent to url=archive.org/&matchtype=prefix, if url starts with *., eg url=*.archive.org/ the query is equivalent to url=archive.org/&matchtype=domain, output: output=json can be added to return results as json array. the json output currently also includes a first line which indicates the cdx format. ex: http://web.archive.org/cdx/search/cdx?url=archive.org&output=json&limit=3, by default, cdx server returns gzip encoded data for all queries. to turn this off, add the gzip=false param, the following returns only the timestamp and mimetype fields with the header [timestamp,mimetype] http://web.archive.org/cdx/search/cdx?url=archive.org&fl=timestamp,mimetype&output=json, if omitted, all the available fields are returned by default., date range: results may be filtered by timestamp using from= and to= params. the ranges are inclusive and are specified in the same 1 to 14 digit format used for wayback captures: yyyymmddhhmmss ex: http://web.archive.org/cdx/search/cdx?url=archive.org&from=2010&to=2011, regex filtering: it is possible to filter on a specific field or the entire cdx line (which is space delimited). filtering by specific field is often simpler. any number of filter params of the following form may be specified: filter=[!]field:regex may be specified. field is one of the named cdx fields (listed in the json query) or an index of the field. it is often useful to filter by mimetype or statuscode optional: ! before the query inverts the match, that is, will return results that do not match the regex. regex is any standard java regex pattern (http://docs.oracle.com/javase/6/docs/api/java/util/regex/pattern.html), field is one of the named cdx fields (listed in the json query) or an index of the field. it is often useful to filter by mimetype or statuscode, optional: ! before the query inverts the match, that is, will return results that do not match the regex., regex is any standard java regex pattern (http://docs.oracle.com/javase/6/docs/api/java/util/regex/pattern.html), ex: query for 2 capture results with a non-200 status code: http://web.archive.org/cdx/search/cdx?url=archive.org&output=json&limit=2&filter=!statuscode:200, ex: query for 10 capture results with a non-200 status code and non text/html mime type matching a specific digest: http://web.archive.org/cdx/search/cdx?url=archive.org&output=json&limit=10&filter=!statuscode:200&filter=!mimetype:text/html&filter=digest:2waxx5nuwnncs2bdkco5ovdqbjvnkivv, ex: only show at most 1 capture per hour (compare the first 10 digits of the timestamp field). given 2 captures 20130226010000 and 20130226010800, since first 10 digits 2013022601 match, the 2nd capture will be filtered out. http://web.archive.org/cdx/search/cdx?url=google.com&collapse=timestamp:10 the calendar page at web.archive.org uses this filter by default: http://web.archive.org/web/*/archive.org, ex: only show unique captures by digest (note that only adjacent digest are collapsed, duplicates elsewhere in the cdx are not affected) http://web.archive.org/cdx/search/cdx?url=archive.org&collapse=digest, ex: only show unique urls in a prefix query (filtering out captures except first capture of a given url). this is similar to the old prefix query in wayback (note: this query may be slow at the moment): http://web.archive.org/cdx/search/cdx?url=archive.org&collapse=urlkey&matchtype=prefix, the cdx server config provides a setting for absolute maximum length returned from a single query (currently set to 150000 by default)., set limit= n to return the first n results., set limit= -n to return the last n results. the query may be slow as it begins reading from the beginning of the search space and skips all but last n results. ex: http://web.archive.org/cdx/search/cdx?url=archive.org&limit=-1, advanced option: fastlatest=true may be set to return some number of latest results for an exact match and is faster than the standard last results search. the number of results is at least 1 so limit=-1 implies this setting. the number of results may be greater >1 when a secondary index format (such as zipnum) is used, but is not guaranteed to return any more than 1 result. combining this setting with limit= will ensure that no more than n last results. ex: this query will result in upto 5 of the latest (by date) query results: http://web.archive.org/cdx/search/cdx?url=archive.org&fastlatest=true&limit=-5, the offset= m param can be used in conjunction with limit to skip the first m records. this allows for a simple way to scroll through the results. however, the offset/limit model does not scale well to large querties since the cdx server must read and skip through the number of results specified by offset, so the cdx server begins reading at the beginning every time., to show the resumption key add showresumekey=true param. when set, the resume key will be printed only if the query has more results that have not be printed due to limit= (or max query limit) number of results reached., after the end of the query, the will be printed on a seperate line or seperate json query., plain text example: http://web.archive.org/cdx/search/cdx?url=archive.org&limit=5&showresumekey=true, json example: http://web.archive.org/cdx/search/cdx?url=archive.org&limit=5&showresumekey=true&output=json, in a subsequent query, adding resumekey= will resume the search from the next result: no other params from the original query (such as from= or url=) need to be altered to continue from the previous example, the subsequent query would be: ex: http://web.archive.org/cdx/search/cdx?url=archive.org&limit=5&showresumekey=true&resumekey=org%2carchive%29%2f+19980109140106%21, the duplicates are determined by tracking rows with the same digest field., the warc/revisit mimetype in duplicates > 0 will automatically be resolved to the mimetype of the original, if found., using showdupecount=true will only show unique captures: http://web.archive.org/cdx/search/cdx?url=archive.org&showdupecount=true&output=json&limit=50, ex: collapse results by year and print number of additional captures skipped and timestamp of last capture: http://web.archive.org/cdx/search/cdx?url=archive.org&collapse=timestamp:4&output=json&showskipcount=true&lastskiptimestamp=true, to use pagination, simply add the page=i param to the query to return the i-th page. if pagination is not supported, the cdx server will return a 400., pages are numbered from 0 to num pages - 1. if i<0, pages are not used. if i>=num pages, no results are returned. ex: first page: http://web.archive.org/cdx/search/cdx?url=archive.org&page=0 ex: next page: http://web.archive.org/cdx/search/cdx?url=archive.org&page=1, to determine the number of pages, add the shownumpages=true param. this is a special query that will return a single number indicating the number of pages ex: http://web.archive.org/cdx/search/cdx?url=archive.org&shownumpages=true, page size is the number of zipnum blocks scanned per page (so a page size of 1 will contain up to 3,000 results per page). this means the number of results on each page will vary, because each block may have a different number of cdx lines matching your query. page size is configured to an optimal value on the cdx server, and may be similar to max query limit in non-paged mode. the cdx server on archive.org currently has a page size of 50., it is possible to adjust the page size to a smaller value than the default by setting the pagesize=p where 1 <= p <= default page size. ex: get # of pages with smallest page size: http://web.archive.org/cdx/search/cdx?url=archive.org&shownumpages=true&pagesize=1 ex: get first page with smallest page size: http://web.archive.org/cdx/search/cdx?url=archive.org&page=0&pagesize=1, if there is only one page, adding the page=0 param will return the same results as without setting a page., it is also possible to have the cdx server return the raw secondary index, by specifying showpagedindex=true. this query returns the secondary index instead of the cdx results and may be subject to access restrictions., all other params, including the resumekey= should work in conjunction with pagination., access to certain urls which are considered private. when restricted, only public urls are included in query results and access to secondary index is restricted., access to certain fields, such as filename in the cdx. when restricted, the cdx results contain only public fields., © 2022 github, inc., terms, privacy, security, status, docs, contact github, pricing, api, training, blog, about]