[last fall, amazon introduced ultrasound-based motion detection, to enable alexa customers to initiate routines, or prespecified sequences of actions, when certain types of motion are detected (or not detected). for instance, routines could be configured to automatically turn the lights on, play music, or announce weather or traffic when motion is detected near a customer’s echo device, indicating that someone has entered the room., there are many different motion detection technologies, but we selected ultrasound because it works in low-light conditions or even in the dark and, unlike radio waves, ultrasound waves do not travel through drywall, so there's less risk of detecting motion in other rooms., getting the technology to work on existing echo hardware required innovation on a number of fronts — among other things, reducing false alarms by adequately sampling long-tail data; devising a self-calibration feature to adjust to variations in commodity hardware; and filtering out distortion during concurrent ultrasound detection and music playback. we describe the details below., , with ultrasound-based presence detection (uspd), an ultrasonic signal (>=32 khz) is transmitted via onboard loudspeakers, and changes in the signal received at the microphones are monitored to detect motion., ultrasound sensors can be broadly categorized as using doppler sensing or time-of-flight sensing. in doppler sensing, once the signal is transmitted, the system detects motion by looking for frequency shifts in the recorded spectrum of the signal, which are caused by its reflection from moving objects. this frequency shift is similar to the shift in sound frequencies you hear in a police car siren it is approaching you or moving away from you., in time-of-flight sensing, variations in the arrival time of the reflected signal are monitored to detect changes in the environment. we use doppler sensing due to the robustness of its motion detection signal and because it generalizes well across the cases when alexa is or is not playing audio simultaneously., the magnitude of the doppler-shifted signal depends on factors such as distance from target to source, the size and absorption coefficient of the target, the absorption coefficient of the room, and even the humidity and temperature in the room. in addition, when a person moves through a closed space, not only do we observe multiple doppler components due to various parts of the body moving in different directions with different speeds, but we also observe repetitions of those components due to reflections., because of all these complexities, the signal received at the source is not at all as clean as a single tone with a frequency shift. in practice, what we observe looks more like this:, further, moving objects such as fans and curtains introduce their own doppler shifts, which have to be rejected since they do not necessarily indicate people’s presence. below are two spectrograms, one of a room with no motion other than a rotating floor fan and another with both a fan and human motion near a device. as can be seen, they are difficult to tell apart., these complications mean that conventional signal processing is insufficient to recognize human motion from doppler-shifted signals. so we instead use deep learning, which should be able to recognize more heterogeneous patterns in the signal., below is a high-level block diagram of our uspd algorithm. on the signal transmitter side, a device- and environment-dependent optimal ultrasound signal is transmitted through the onboard loudspeaker. this signal gets reflected from a moving object and is then captured by the onboard microphone array. the signal is preprocessed and then passed to a neural-network-based classifier to detect motion., , , the biggest algorithmic challenge we faced was achieving high detection accuracy while keeping the false-alarm rate low. reducing false-alarm rates is especially challenging because of the well-known long-tail problem in ai: there are a multitude of rare events that could fool a detector, but their rarity means that they’re usually underrepresented in training data., to address this problem, we started by training a seed model on a relatively small amount of data. first, we used the seed model to sort through large amounts of data and extract infrequent events. second, we used a model trained on that rare-event data to automatically capture infrequent events during our internal data collection process. data captured by these methods eventually helped us address the long-tail problem and achieve extremely low false-alarm rates., , deploying the trained model brought its own challenges. we wanted to enable uspd with the lowest possible emission level, while still retaining a sufficient detection range, and do all of this with no additional hardware costs (i.e., using the available microphones and loudspeakers on echo devices instead of dedicated ultrasound transmitters). further, we decided to support always-on motion detection. this meant being able to detect motion even when a user is playing music from the device speakers. finally, we added algorithms to improve the user experience in the presence of only minor motion and spent a considerable amount of effort to support amazon’s goal of reducing our devices’ power consumption. we describe these in more detail below., , using onboard loudspeakers and microphones for ultrasound transmission and sensing meant that we had to manage variable acoustic characteristics. mass-produced devices are known to have a certain variation in amplitude and phase response, and it is very difficult to control the response of loudspeakers in the ultrasonic frequency range without affecting yield rates. to manage these hardware variations and environmental variations, we designed automatic device calibration modules to tailor emission frequencies and levels to both the devices’ hardware idiosyncrasies and the acoustic properties of the rooms in which they are used. this helped us provide a consistent user experience across devices without increasing device costs., , , music playback is a key use case for echo devices, which poses challenges, since we use device loudspeakers to simultaneously play music and emit ultrasound. specifically, when low-frequency music content (such as bass sounds) is played together with an ultrasonic signal, the distortion shows up as noise in the ultrasound region. this noise is inaudible to listeners, but it interferes with the frequencies we use for sensing., in order to enhance the ultrasound signal and get reasonable range performance in the presence of concurrent music, we developed an adaptive algorithm that uses the different magnitude and phase of distortion and motion features at different microphones to identify and remove distortion., , human movements can be broadly categorized as either major or minor. major movements include walking into or through an area, while minor movements include reaching for a telephone while seated, turning the pages in a book, opening a file folder, and picking up a coffee cup. detecting minor movements is difficult, as their ultrasound spectra have very low signal-to-noise ratios (snrs) compared to major movements, and detecting low-snr events often means high false-positive rates. at the same time, detecting minor movements is extremely important for recognizing a user’s continued presence after walking into the room., we developed an algorithm that changes the sensitivity of the detector based on context, such as time elapsed since the last major movement. after a customer walks into the room, the device operates at high sensitivity to detect minor movements for continued presence sensing, so we can provide the best of both worlds — high sensitivity to movements and low false-alarm rates., , reducing power consumption is an important goal at amazon, so we implemented our solution on a low-power digital signal processor (dsp). this required a lot of code and optimizations of the neural-network architecture., specifically, as real-time systems, dsps have strict computation schedules and budgets. this prevented us from deploying deeper neural network models, but we managed to trade off detection latency (on the order of 50 milliseconds) for higher accuracy by combining our neural models with custom dsp implementations. in addition, we disable ultrasonic emission when it is not essential; for example, we disable emissions for set periods of time after detecting presence., the launch of far-field ultrasonic motion sensing on echo devices is an exciting development, which will enable our customers to easily automate their day-to-day needs. we are looking forward to inventing more on behalf of our customers., acknowledgments: special thanks to tarun pruthi for his contributions to this post.][the science behind ultrasonic motion sensing for echo, reducing false positives for rare events, adapting echo hardware to ultrasound sensing, and enabling concurrent ultrasound sensing and music playback are just a few challenges amazon researchers addressed., ultrasound-based presence detection, false alarms, deployment challenges, hardware variations and environmental conditions, sensing with concurrent music playback, major and minor motion, low-power mode, related content, work with us]the science behind ultrasonic motion sensing for echo - amazon science[][research areas automated reasoning cloud and systems computer vision conversational ai / natural-language processing economics information and knowledge management machine learning operations research and optimization quantum technologies robotics search and information retrieval security, privacy, and abuse prevention sustainability automated reasoning cloud and systems computer vision conversational ai / natural-language processing economics information and knowledge management machine learning operations research and optimization quantum technologies robotics search and information retrieval security, privacy, and abuse prevention sustainability, automated reasoning, cloud and systems, computer vision, conversational ai / natural-language processing, economics, information and knowledge management, machine learning, operations research and optimization, quantum technologies, robotics, search and information retrieval, security, privacy, and abuse prevention, sustainability, automated reasoning, cloud and systems, computer vision, conversational ai / natural-language processing, economics, information and knowledge management, machine learning, operations research and optimization, quantum technologies, robotics, search and information retrieval, security, privacy, and abuse prevention, sustainability, blog, news and features awards and recognitions awards and recognitions, awards and recognitions, awards and recognitions, publications, conferences, collaborations academics at amazon alexa prize amazon research awards academics at amazon alexa prize amazon research awards, academics at amazon, alexa prize, amazon research awards, academics at amazon, alexa prize, amazon research awards, careers internships working at amazon internships working at amazon, internships, working at amazon, internships, working at amazon, twitter, instagram, youtube, facebook, linkedin, research areas automated reasoning cloud and systems computer vision conversational ai / natural-language processing economics information and knowledge management machine learning operations research and optimization quantum technologies robotics search and information retrieval security, privacy, and abuse prevention sustainability automated reasoning cloud and systems computer vision conversational ai / natural-language processing economics information and knowledge management machine learning operations research and optimization quantum technologies robotics search and information retrieval security, privacy, and abuse prevention sustainability, automated reasoning, cloud and systems, computer vision, conversational ai / natural-language processing, economics, information and knowledge management, machine learning, operations research and optimization, quantum technologies, robotics, search and information retrieval, security, privacy, and abuse prevention, sustainability, automated reasoning, cloud and systems, computer vision, conversational ai / natural-language processing, economics, information and knowledge management, machine learning, operations research and optimization, quantum technologies, robotics, search and information retrieval, security, privacy, and abuse prevention, sustainability, blog, news and features awards and recognitions awards and recognitions, awards and recognitions, awards and recognitions, publications, conferences, collaborations academics at amazon alexa prize amazon research awards academics at amazon alexa prize amazon research awards, academics at amazon, alexa prize, amazon research awards, academics at amazon, alexa prize, amazon research awards, careers internships working at amazon internships working at amazon, internships, working at amazon, internships, working at amazon, facebook, twitter, linkedin, email, conversational ai / natural-language processing, hardware, signal processing, alexa, new alexa feature enables natural, multiparty interactions the alexa ai team november 18, 2021 in conversation mode, alexa detects device-directed speech without the need for the wake word. conversational ai / natural-language processing, credit: syntiant 3 questions with jeremy holleman: how to design and develop ultra-low-power ai processors staff writer august 11, 2021 holleman, the chief scientist of alexa fund company syntiant, explains why the company’s new architecture allows machine learning to be deployed practically anywhere. conversational ai / natural-language processing, the science behind an amazon echo feature that helped save a puppy staff writer may 17, 2021 how acoustic event detection helps alexa guard understand what might warrant an alert — and what just might be a microwave beeping. machine learning, about, research areas, blog, news and features, publications, conferences, collaborations, careers, alexa prize, academics, research awards, amazon developer, amazon web services, about amazon, newsletter, rss, twitter, instagram, youtube, facebook, linkedin]